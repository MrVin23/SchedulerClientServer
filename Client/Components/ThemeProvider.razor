@using MudBlazor

<MudThemeProvider @ref="_mudThemeProvider" 
                  @bind-IsDarkMode="_isDarkMode" 
                  Theme="_theme"
                  DefaultScrollbar="true" />

@code {
    private bool _isDarkMode;
    private MudThemeProvider? _mudThemeProvider;
    
    private MudTheme _theme = new MudTheme()
    {
        PaletteLight = new PaletteLight()
        {
            // Custom dark theme colors (using light palette with dark colors)
            Primary = Colors.LightGreen.Accent3,
            Secondary = Colors.Shades.White,
            Tertiary = Colors.Purple.Lighten3,
            Error = Colors.Red.Darken3,
            Success = Colors.Green.Accent3,
            Warning = Colors.Orange.Lighten2,
            Info = Colors.Cyan.Lighten3,
            AppbarBackground = Colors.Teal.Darken3,
            Background = Colors.Gray.Lighten5,
            Surface = Colors.Teal.Darken4,
            DrawerBackground = Colors.Teal.Darken4,
            DrawerText = Colors.Shades.White,
            DrawerIcon = Colors.Shades.White,
            // Text colors for light contrast on dark background
            TextPrimary = Colors.Shades.White,
            TextSecondary = Colors.Shades.White,
            TextDisabled = Colors.Shades.Black,
            // Action colors
            ActionDefault = "#FFFFFF",
            Divider = Colors.Shades.Black,
            
        },
        PaletteDark = new PaletteDark()
        {
            // Dark theme colors
            Primary = Colors.Blue.Lighten1,
            Secondary = Colors.Teal.Accent4,
            Tertiary = Colors.Purple.Accent3,
            Error = Colors.Red.Accent2,
            Success = Colors.Green.Accent3,
            Warning = Colors.Orange.Lighten1,
            Info = Colors.Blue.Lighten1,
            AppbarBackground = "#1e1e1e",
            Background = "#121212",
            Surface = "#1e1e1e",
            DrawerBackground = "#1e1e1e",
            DrawerText = Colors.Shades.White,
            DrawerIcon = Colors.Shades.White
        },
        
        Typography = new Typography()
        {
            // You can customize typography here if needed
        },
        
        LayoutProperties = new LayoutProperties()
        {
            // You can customize layout properties here if needed
        }
    };

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender && _mudThemeProvider is not null)
        {
            // Watch system preference for dark mode
            await _mudThemeProvider.WatchSystemDarkModeAsync(OnSystemDarkModeChanged);
            StateHasChanged();
        }
    }

    private Task OnSystemDarkModeChanged(bool newValue)
    {
        _isDarkMode = newValue;
        StateHasChanged();
        return Task.CompletedTask;
    }

    // Public method to toggle dark mode programmatically
    public void ToggleDarkMode()
    {
        _isDarkMode = !_isDarkMode;
        StateHasChanged();
    }

    // Public property to get current dark mode state
    public bool IsDarkMode => _isDarkMode;
}

