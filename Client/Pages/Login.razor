@page "/"
@page "/login"
@using Client.Dtos

<PageTitle>Login</PageTitle>

<div class="container mt-5" style="max-width: 400px;">
    <div class="card shadow">
        <div class="card-body p-4">
            <h4 class="card-title text-center mb-4">Login</h4>
            
            <EditForm Model="@loginRequest" OnValidSubmit="HandleLogin">
                <DataAnnotationsValidator />
                
                <div class="mb-3">
                    <label for="username" class="form-label">Username</label>
                    <InputText id="username" class="form-control" @bind-Value="loginRequest.Username" placeholder="Enter username" />
                    <ValidationMessage For="@(() => loginRequest.Username)" class="text-danger small" />
                </div>
                
                <div class="mb-4">
                    <label for="password" class="form-label">Password</label>
                    <div class="input-group">
                        <input type="@(showPassword ? "text" : "password")" 
                               id="password" 
                               class="form-control" 
                               @bind="loginRequest.Password"
                               placeholder="Enter password" />
                        <button class="btn btn-outline-secondary" type="button" @onclick="TogglePasswordVisibility">
                            <i class="bi @(showPassword ? "bi-eye-slash" : "bi-eye")"></i>
                        </button>
                    </div>
                    <ValidationMessage For="@(() => loginRequest.Password)" class="text-danger small" />
                </div>
                
                <button type="submit" class="btn btn-primary w-100" disabled="@isLoading">
                    @if (isLoading)
                    {
                        <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                        <span>Logging in...</span>
                    }
                    else
                    {
                        <span>Login</span>
                    }
                </button>
            </EditForm>
            
            @if (!string.IsNullOrEmpty(errorMessage))
            {
                <div class="alert alert-danger mt-4 mb-0">@errorMessage</div>
            }
        </div>
    </div>
</div>
